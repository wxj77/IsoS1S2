
function Level1_r2_sbatch_(iij)

pc=parcluster('local');
JOB_ID=getenv('SLURM_JOBID');
CPUS=str2num(getenv('SLURM_JOB_CPUS_PER_NODE'));
pc.JobStorageLocation=strcat('/local_scratch/',JOB_ID);
parpool(pc,CPUS)
DataSets{1,1}='lux10_20141207T2209';
DataSets{1,2}='lux10_20141208T0307';
DataSets{1,3}='lux10_20141208T0803';
DataSets{1,4}='lux10_20141208T1400';
DataSets{1,5}='lux10_20141209T0803';
DataSets{1,6}='lux10_20141209T1051';
DataSets{1,7}='lux10_20141209T1415';
DataSets{1,8}='lux10_20141209T1735';
DataSets{1,9}='lux10_20141209T2123';
DataSets{1,10}='lux10_20141210T0113';
DataSets{1,11}='lux10_20141210T0459';
DataSets{1,12}='lux10_20141210T1710';
DataSets{1,13}='lux10_20141215T0248';
DataSets{1,14}='lux10_20141215T0631';
DataSets{1,15}='lux10_20141216T0541';
DataSets{1,16}='lux10_20141216T0901';
DataSets{1,17}='lux10_20141216T1216';
DataSets{1,18}='lux10_20141216T1531';
DataSets{1,19}='lux10_20141216T1904';
DataSets{1,20}='lux10_20141216T2254';
DataSets{1,21}='lux10_20141217T0244';
DataSets{1,22}='lux10_20141217T0635';
DataSets{1,23}='lux10_20141217T1001';
DataSets{1,24}='lux10_20141217T1309';
DataSets{1,25}='lux10_20141217T1616';
DataSets{1,26}='lux10_20141217T1957';
DataSets{1,27}='lux10_20141217T2339';
DataSets{1,28}='lux10_20141218T0322';
DataSets{1,29}='lux10_20141218T0705';
DataSets{1,30}='lux10_20141218T1023';
DataSets{1,31}='lux10_20141218T1334';
DataSets{1,32}='lux10_20141218T1642';
DataSets{1,33}='lux10_20141218T2014';
DataSets{1,34}='lux10_20141218T2357';
DataSets{1,35}='lux10_20141219T0342';
DataSets{1,36}='lux10_20141219T0733';
DataSets{1,37}='lux10_20141219T1120';
DataSets{1,38}='lux10_20141220T0543';
DataSets{1,39}='lux10_20141220T0926';
DataSets{1,40}='lux10_20141220T1310';
DataSets{1,41}='lux10_20141220T1654';
DataSets{1,42}='lux10_20141220T2039';
DataSets{1,43}='lux10_20141221T0017';
DataSets{1,44}='lux10_20141221T0151';
DataSets{1,45}='lux10_20141221T0601';
DataSets{1,46}='lux10_20141221T1036';
DataSets{1,47}='lux10_20141221T1355';
DataSets{1,48}='lux10_20141221T1711';
DataSets{1,49}='lux10_20141221T2031';
DataSets{1,50}='lux10_20141221T2353';
DataSets{1,51}='lux10_20141222T0309';
DataSets{1,52}='lux10_20141222T0937';
DataSets{1,53}='lux10_20141222T1244';
DataSets{1,54}='lux10_20141222T1557';
DataSets{1,55}='lux10_20141222T1918';
DataSets{1,56}='lux10_20141222T2243';
DataSets{1,57}='lux10_20141223T0215';
DataSets{1,58}='lux10_20141223T0556';
DataSets{1,59}='lux10_20141223T0935';
DataSets{1,60}='lux10_20141223T1317';
DataSets{1,61}='lux10_20150103T0308';
DataSets{1,62}='lux10_20150103T0609';
DataSets{1,63}='lux10_20150103T0918';
DataSets{1,64}='lux10_20150103T1230';
DataSets{1,65}='lux10_20150103T1547';
DataSets{1,66}='lux10_20150103T1907';
DataSets{1,67}='lux10_20150103T2235';
DataSets{1,68}='lux10_20150104T0601';
DataSets{1,69}='lux10_20150104T1108';
DataSets{1,70}='lux10_20150104T1445';
DataSets{1,71}='lux10_20150104T1818';
DataSets{1,72}='lux10_20150104T2156';
DataSets{1,73}='lux10_20150105T0128';
DataSets{1,74}='lux10_20150105T0458';
DataSets{1,75}='lux10_20150105T0819';
DataSets{1,76}='lux10_20150105T1136';
DataSets{1,77}='lux10_20150105T1459';
DataSets{1,78}='lux10_20150106T0823';
DataSets{1,79}='lux10_20150106T1655';
DataSets{1,80}='lux10_20150106T2002';
DataSets{1,81}='lux10_20150106T2314';
DataSets{1,82}='lux10_20150107T0226';
DataSets{1,83}='lux10_20150107T0543';
DataSets{1,84}='lux10_20150107T1008';
DataSets{1,85}='lux10_20150107T1242';
DataSets{1,86}='lux10_20150107T1833';
DataSets{1,87}='lux10_20150107T2126';
DataSets{1,88}='lux10_20150108T0019';
DataSets{1,89}='lux10_20150108T0313';
DataSets{1,90}='lux10_20150108T0608';
DataSets{1,91}='lux10_20150109T0545';
DataSets{1,92}='lux10_20150109T0848';
DataSets{1,93}='lux10_20150109T1443';
DataSets{1,94}='lux10_20150109T1749';
DataSets{1,95}='lux10_20150109T2057';
DataSets{1,96}='lux10_20150109T2357';
DataSets{1,97}='lux10_20150309T1044';
DataSets{1,98}='lux10_20150310T0156';
DataSets{1,99}='lux10_20150310T0938';
DataSets{1,100}='lux10_20150310T1711';
DataSets{1,101}='lux10_20150311T0056';
DataSets{1,102}='lux10_20150311T0839';
DataSets{1,103}='lux10_20150311T1614';
DataSets{1,104}='lux10_20150311T2354';
DataSets{1,105}='lux10_20150312T1131';
DataSets{1,106}='lux10_20150312T1913';
DataSets{1,107}='lux10_20150313T0257';
DataSets{1,108}='lux10_20150313T1040';
DataSets{1,109}='lux10_20150313T1817';
DataSets{1,110}='lux10_20150314T0201';
DataSets{1,111}='lux10_20150315T0926';
DataSets{1,112}='lux10_20150315T1706';
DataSets{1,113}='lux10_20150315T2238';
DataSets{1,114}='lux10_20150317T2145';
DataSets{1,115}='lux10_20150318T0522';
DataSets{1,116}='lux10_20150318T1539';
DataSets{1,117}='lux10_20150318T2311';
DataSets{1,118}='lux10_20150319T0647';
DataSets{1,119}='lux10_20150319T1232';
DataSets{1,120}='lux10_20150319T2118';
DataSets{1,121}='lux10_20150320T0458';
DataSets{1,122}='lux10_20150322T1712';
DataSets{1,123}='lux10_20150322T2223';
DataSets{1,124}='lux10_20150323T0333';
DataSets{1,125}='lux10_20150323T0959';
DataSets{1,126}='lux10_20150402T1027';
DataSets{1,127}='lux10_20150602T0935';
DataSets{1,128}='lux10_20150602T1750';
DataSets{1,129}='lux10_20150603T0154';
DataSets{1,130}='lux10_20150603T0943';
DataSets{1,131}='lux10_20150603T1933';
DataSets{1,132}='lux10_20150604T0333';
DataSets{1,133}='lux10_20150604T1124';
DataSets{1,134}='lux10_20150604T1928';
DataSets{1,135}='lux10_20150605T0325';
DataSets{1,136}='lux10_20150605T1753';
DataSets{1,137}='lux10_20150606T0204';
DataSets{1,138}='lux10_20150607T1009';
DataSets{1,139}='lux10_20150607T1822';
DataSets{1,140}='lux10_20150608T0245';
DataSets{1,141}='lux10_20150608T1059';
DataSets{1,142}='lux10_20150608T1914';
DataSets{1,143}='lux10_20150609T0327';
DataSets{1,144}='lux10_20150609T1428';
DataSets{1,145}='lux10_20150609T2235';
DataSets{1,146}='lux10_20150610T1052';
DataSets{1,147}='lux10_20150610T1851';
DataSets{1,148}='lux10_20150611T0304';
DataSets{1,149}='lux10_20150611T1226';
DataSets{1,150}='lux10_20150611T2029';
DataSets{1,151}='lux10_20150612T0438';
DataSets{1,152}='lux10_20150612T1124';
DataSets{1,153}='lux10_20150612T1932';
DataSets{1,154}='lux10_20150613T0327';
DataSets{1,155}='lux10_20150614T1239';
DataSets{1,156}='lux10_20150614T2051';
DataSets{1,157}='lux10_20150615T0454';
DataSets{1,158}='lux10_20150615T1605';
DataSets{1,159}='lux10_20150616T0014';
DataSets{1,160}='lux10_20150616T0823';
DataSets{1,161}='lux10_20150616T1624';
DataSets{1,162}='lux10_20150617T0016';
DataSets{1,163}='lux10_20150618T0602';
DataSets{1,164}='lux10_20150618T1642';
DataSets{1,165}='lux10_20150619T0046';
DataSets{1,166}='lux10_20150619T0854';
DataSets{1,167}='lux10_20150619T1659';
DataSets{1,168}='lux10_20150620T0105';
DataSets{1,169}='lux10_20150620T0907';
DataSets{1,170}='lux10_20150620T1710';
DataSets{1,171}='lux10_20150621T0151';
DataSets{1,172}='lux10_20150621T0956';
DataSets{1,173}='lux10_20150621T1800';
DataSets{1,174}='lux10_20150622T0159';
DataSets{1,175}='lux10_20150622T0956';
DataSets{1,176}='lux10_20150622T1757';
DataSets{1,177}='lux10_20150623T0203';
DataSets{1,178}='lux10_20150623T1527';
DataSets{1,179}='lux10_20150623T2328';
DataSets{1,180}='lux10_20150624T0723';
DataSets{1,181}='lux10_20150624T1345';
DataSets{1,182}='lux10_20150625T1233';
DataSets{1,183}='lux10_20150625T1821';
DataSets{1,184}='lux10_20150626T0029';
DataSets{1,185}='lux10_20150626T0616';
DataSets{1,186}='lux10_20150626T0949';
DataSets{1,187}='lux10_20150626T1240';
DataSets{1,188}='lux10_20150626T1727';
DataSets{1,189}='lux10_20150626T2040';
DataSets{1,190}='lux10_20150627T0006';
DataSets{1,191}='lux10_20150627T0340';
DataSets{1,192}='lux10_20150627T0719';
DataSets{1,193}='lux10_20150627T1052';
DataSets{1,194}='lux10_20150627T1331';
DataSets{1,195}='lux10_20150627T1758';
DataSets{1,196}='lux10_20150627T2025';
DataSets{1,197}='lux10_20150627T2304';
DataSets{1,198}='lux10_20150628T0151';
DataSets{1,199}='lux10_20150628T0542';
DataSets{1,200}='lux10_20150628T1143';
DataSets{1,201}='lux10_20150628T1941';
DataSets{1,202}='lux10_20150629T0342';
DataSets{1,203}='lux10_20150629T1240';
DataSets{1,204}='lux10_20150629T2034';
DataSets{1,205}='lux10_20150630T0423';
DataSets{1,206}='lux10_20150630T1211';
DataSets{1,207}='lux10_20150630T2008';
DataSets{1,208}='lux10_20150701T0404';
DataSets{1,209}='lux10_20150702T1405';
DataSets{1,210}='lux10_20150702T2152';
DataSets{1,211}='lux10_20150703T0539';
DataSets{1,212}='lux10_20150703T1322';
DataSets{1,213}='lux10_20150703T2109';
DataSets{1,214}='lux10_20150704T0457';
DataSets{1,215}='lux10_20150705T0959';
DataSets{1,216}='lux10_20150705T1805';
DataSets{1,217}='lux10_20150706T0208';
DataSets{1,218}='lux10_20150706T0959';
DataSets{1,219}='lux10_20150706T1806';
DataSets{1,220}='lux10_20150707T0207';
DataSets{1,221}='lux10_20150707T1423';
DataSets{1,222}='lux10_20150707T2220';
DataSets{1,223}='lux10_20150708T0615';
DataSets{1,224}='lux10_20150709T1511';
DataSets{1,225}='lux10_20150709T2312';
DataSets{1,226}='lux10_20150710T0712';
DataSets{1,227}='lux10_20150710T1509';
DataSets{1,228}='lux10_20150710T2313';
DataSets{1,229}='lux10_20150711T0712';
DataSets{1,230}='lux10_20150711T1516';
DataSets{1,231}='lux10_20150711T2318';
DataSets{1,232}='lux10_20150712T0151';
DataSets{1,233}='lux10_20150712T0950';
DataSets{1,234}='lux10_20150712T1846';
DataSets{1,235}='lux10_20150713T0242';
DataSets{1,236}='lux10_20150713T1444';
DataSets{1,237}='lux10_20150713T2242';
DataSets{1,238}='lux10_20150714T0647';
DataSets{1,239}='lux10_20150714T1050';
DataSets{1,240}='lux10_20150714T1848';
DataSets{1,241}='lux10_20150715T0252';
DataSets{1,242}='lux10_20150716T0712';
DataSets{1,243}='lux10_20150716T1514';
DataSets{1,244}='lux10_20150716T2313';
DataSets{1,245}='lux10_20150717T0714';
DataSets{1,246}='lux10_20150717T1514';
DataSets{1,247}='lux10_20150717T2312';
DataSets{1,248}='lux10_20150718T0715';
DataSets{1,249}='lux10_20150718T1519';
DataSets{1,250}='lux10_20150718T2317';
DataSets{1,251}='lux10_20150719T0151';
DataSets{1,252}='lux10_20150719T0950';
DataSets{1,253}='lux10_20150719T1751';
DataSets{1,254}='lux10_20150720T0008';
DataSets{1,255}='lux10_20150720T0809';
DataSets{1,256}='lux10_20150720T1605';
DataSets{1,257}='lux10_20150720T2359';
DataSets{1,258}='lux10_20150721T0513';
DataSets{1,259}='lux10_20150721T1118';
DataSets{1,260}='lux10_20150721T1910';
DataSets{1,261}='lux10_20150722T0310';
DataSets{1,262}='lux10_20150723T0937';
DataSets{1,263}='lux10_20150723T1726';
DataSets{1,264}='lux10_20150724T0124';
DataSets{1,265}='lux10_20150724T0920';
DataSets{1,266}='lux10_20150724T1719';
DataSets{1,267}='lux10_20150725T0116';
DataSets{1,268}='lux10_20150725T0914';
DataSets{1,269}='lux10_20150725T1709';
DataSets{1,270}='lux10_20150726T0151';
DataSets{1,271}='lux10_20150726T0947';
DataSets{1,272}='lux10_20150726T1744';
DataSets{1,273}='lux10_20150727T0138';
DataSets{1,274}='lux10_20150727T1032';
DataSets{1,275}='lux10_20150727T1442';
DataSets{1,276}='lux10_20150727T2235';
DataSets{1,277}='lux10_20150728T0626';
DataSets{1,278}='lux10_20150728T1418';
DataSets{1,279}='lux10_20150728T2210';
DataSets{1,280}='lux10_20150729T0605';
DataSets{1,281}='lux10_20150730T0921';
DataSets{1,282}='lux10_20150730T1710';
DataSets{1,283}='lux10_20150731T0105';
DataSets{1,284}='lux10_20150731T0857';
DataSets{1,285}='lux10_20150731T1655';
DataSets{1,286}='lux10_20150801T0046';
DataSets{1,287}='lux10_20150801T0840';
DataSets{1,288}='lux10_20150801T1638';
DataSets{1,289}='lux10_20150802T0151';
DataSets{1,290}='lux10_20150802T0949';
DataSets{1,291}='lux10_20150802T1746';
DataSets{1,292}='lux10_20150803T0143';
DataSets{1,293}='lux10_20150803T0945';
DataSets{1,294}='lux10_20150803T1742';
DataSets{1,295}='lux10_20150804T0141';
DataSets{1,296}='lux10_20150804T0935';
DataSets{1,297}='lux10_20150804T1245';
DataSets{1,298}='lux10_20150804T2041';
DataSets{1,299}='lux10_20150805T0436';
DataSets{1,300}='lux10_20150806T1622';
DataSets{1,301}='lux10_20150807T0017';
DataSets{1,302}='lux10_20150807T0807';
DataSets{1,303}='lux10_20150807T1601';
DataSets{1,304}='lux10_20150808T0002';
DataSets{1,305}='lux10_20150808T0754';
DataSets{1,306}='lux10_20150808T1548';
DataSets{1,307}='lux10_20150808T2336';
DataSets{1,308}='lux10_20150809T0151';
DataSets{1,309}='lux10_20150809T0950';
DataSets{1,310}='lux10_20150809T1744';
DataSets{1,311}='lux10_20150810T0137';
DataSets{1,312}='lux10_20150810T0929';
DataSets{1,313}='lux10_20150810T1705';
DataSets{1,314}='lux10_20150811T0055';
DataSets{1,315}='lux10_20150811T0841';
DataSets{1,316}='lux10_20150811T1617';
DataSets{1,317}='lux10_20150812T0009';
DataSets{1,318}='lux10_20150812T0759';
DataSets{1,319}='lux10_20150813T1521';
DataSets{1,320}='lux10_20150813T2307';
DataSets{1,321}='lux10_20150814T0700';
DataSets{1,322}='lux10_20150814T1459';
DataSets{1,323}='lux10_20150814T2251';
DataSets{1,324}='lux10_20150815T0645';
DataSets{1,325}='lux10_20150815T1434';
DataSets{1,326}='lux10_20150815T2226';
DataSets{1,327}='lux10_20150816T0151';
DataSets{1,328}='lux10_20150816T0943';
DataSets{1,329}='lux10_20150816T1740';
DataSets{1,330}='lux10_20150817T0135';
DataSets{1,331}='lux10_20150817T0926';
DataSets{1,332}='lux10_20150817T1721';
DataSets{1,333}='lux10_20150818T0112';
DataSets{1,334}='lux10_20150818T0929';
DataSets{1,335}='lux10_20150818T1716';
DataSets{1,336}='lux10_20150819T0110';
DataSets{1,337}='lux10_20150820T1507';
DataSets{1,338}='lux10_20150820T2302';
DataSets{1,339}='lux10_20150821T0829';
DataSets{1,340}='lux10_20150821T1616';
DataSets{1,341}='lux10_20150822T0008';
DataSets{1,342}='lux10_20150822T0805';
DataSets{1,343}='lux10_20150822T1556';
DataSets{1,344}='lux10_20150823T0151';
DataSets{1,345}='lux10_20150823T0944';
DataSets{1,346}='lux10_20150823T1737';
DataSets{1,347}='lux10_20150824T0131';
DataSets{1,348}='lux10_20150824T1017';
DataSets{1,349}='lux10_20150824T1755';
DataSets{1,350}='lux10_20150825T0153';
DataSets{1,351}='lux10_20150825T0941';
DataSets{1,352}='lux10_20150825T1724';
DataSets{1,353}='lux10_20150826T0115';
DataSets{1,354}='lux10_20150827T1055';
DataSets{1,355}='lux10_20150827T1837';
DataSets{1,356}='lux10_20150828T0226';
DataSets{1,357}='lux10_20150828T1024';
DataSets{1,358}='lux10_20150828T1819';
DataSets{1,359}='lux10_20150829T0215';
DataSets{1,360}='lux10_20150829T1006';
DataSets{1,361}='lux10_20150829T1335';
DataSets{1,362}='lux10_20150829T2124';
DataSets{1,363}='lux10_20150830T0151';
DataSets{1,364}='lux10_20150830T0949';
DataSets{1,365}='lux10_20150830T1746';
DataSets{1,366}='lux10_20150831T0139';
DataSets{1,367}='lux10_20150831T0936';
DataSets{1,368}='lux10_20150831T1731';
DataSets{1,369}='lux10_20150901T0125';
DataSets{1,370}='lux10_20150901T0918';
DataSets{1,371}='lux10_20150901T1702';
DataSets{1,372}='lux10_20150902T0102';
DataSets{1,373}='lux10_20150902T0856';
DataSets{1,374}='lux10_20150903T1007';
DataSets{1,375}='lux10_20150903T1756';
DataSets{1,376}='lux10_20150904T0152';
DataSets{1,377}='lux10_20150904T0940';
DataSets{1,378}='lux10_20150904T1731';
DataSets{1,379}='lux10_20150905T0123';
DataSets{1,380}='lux10_20150905T0920';
DataSets{1,381}='lux10_20150905T1716';
DataSets{1,382}='lux10_20150906T0151';
DataSets{1,383}='lux10_20150906T0947';
DataSets{1,384}='lux10_20150906T1744';
DataSets{1,385}='lux10_20150907T0138';
DataSets{1,386}='lux10_20150907T1125';
DataSets{1,387}='lux10_20150907T1923';
DataSets{1,388}='lux10_20150908T0317';
DataSets{1,389}='lux10_20150908T1103';
DataSets{1,390}='lux10_20150908T1840';
DataSets{1,391}='lux10_20150909T0234';
DataSets{1,392}='lux10_20150910T1234';
DataSets{1,393}='lux10_20150910T2045';
DataSets{1,394}='lux10_20150911T0450';
DataSets{1,395}='lux10_20150911T1258';
DataSets{1,396}='lux10_20150911T2108';
DataSets{1,397}='lux10_20150912T0515';
DataSets{1,398}='lux10_20150912T2128';
DataSets{1,399}='lux10_20150913T0151';
DataSets{1,400}='lux10_20150913T0955';
DataSets{1,401}='lux10_20150913T1803';
DataSets{1,402}='lux10_20150914T0211';
DataSets{1,403}='lux10_20150914T1019';
DataSets{1,404}='lux10_20150914T1824';
DataSets{1,405}='lux10_20150915T0235';
DataSets{1,406}='lux10_20150915T1155';
DataSets{1,407}='lux10_20150915T2003';
DataSets{1,408}='lux10_20150916T0409';
DataSets{1,409}='lux10_20150917T1001';
DataSets{1,410}='lux10_20150917T2012';
DataSets{1,411}='lux10_20150918T0419';
DataSets{1,412}='lux10_20150918T1328';
DataSets{1,413}='lux10_20150920T1000';
DataSets{1,414}='lux10_20150920T1807';
DataSets{1,415}='lux10_20150921T0216';
DataSets{1,416}='lux10_20150921T0950';
DataSets{1,417}='lux10_20150921T1753';
DataSets{1,418}='lux10_20150922T0201';
DataSets{1,419}='lux10_20150922T1009';
DataSets{1,420}='lux10_20150922T1817';
DataSets{1,421}='lux10_20150923T0225';
DataSets{1,422}='lux10_20150924T0747';
DataSets{1,423}='lux10_20150924T1555';
DataSets{1,424}='lux10_20150925T0003';
DataSets{1,425}='lux10_20150925T0807';
DataSets{1,426}='lux10_20150925T1615';
DataSets{1,427}='lux10_20150926T0016';
DataSets{1,428}='lux10_20150926T0822';
DataSets{1,429}='lux10_20150926T1625';
DataSets{1,430}='lux10_20150927T0151';
DataSets{1,431}='lux10_20150927T0955';
DataSets{1,432}='lux10_20150927T1759';
DataSets{1,433}='lux10_20150928T0203';
DataSets{1,434}='lux10_20150928T1004';
DataSets{1,435}='lux10_20150928T1803';
DataSets{1,436}='lux10_20151002T1557';
DataSets{1,437}='lux10_20151002T1822';
DataSets{1,438}='lux10_20151005T0359';
DataSets{1,439}='lux10_20151014T1925';
DataSets{1,440}='lux10_20151015T0310';
DataSets{1,441}='lux10_20151015T1051';
DataSets{1,442}='lux10_20151015T1836';
DataSets{1,443}='lux10_20151016T0223';
DataSets{1,444}='lux10_20151016T0948';
DataSets{1,445}='lux10_20151016T1421';
DataSets{1,446}='lux10_20151016T2210';
DataSets{1,447}='lux10_20151017T0556';
DataSets{1,448}='lux10_20151017T1346';
DataSets{1,449}='lux10_20151017T2137';
DataSets{1,450}='lux10_20151018T0151';
DataSets{1,451}='lux10_20151018T0942';
DataSets{1,452}='lux10_20151018T1734';
DataSets{1,453}='lux10_20151019T0124';
DataSets{1,454}='lux10_20151019T1037';
DataSets{1,455}='lux10_20151019T1536';
DataSets{1,456}='lux10_20151019T2332';
DataSets{1,457}='lux10_20151020T0920';
DataSets{1,458}='lux10_20151020T1727';
DataSets{1,459}='lux10_20151021T0126';
DataSets{1,460}='lux10_20151021T0931';
DataSets{1,461}='lux10_20151022T1129';
DataSets{1,462}='lux10_20151022T1925';
DataSets{1,463}='lux10_20151023T0315';
DataSets{1,464}='lux10_20151023T1104';
DataSets{1,465}='lux10_20151023T1859';
DataSets{1,466}='lux10_20151024T0250';
DataSets{1,467}='lux10_20151024T1047';
DataSets{1,468}='lux10_20151024T1843';
DataSets{1,469}='lux10_20151025T0151';
DataSets{1,470}='lux10_20151025T0950';
DataSets{1,471}='lux10_20151025T1747';
DataSets{1,472}='lux10_20151026T0143';
DataSets{1,473}='lux10_20151026T0940';
DataSets{1,474}='lux10_20151026T2053';
DataSets{1,475}='lux10_20151027T0446';
DataSets{1,476}='lux10_20151028T1625';
DataSets{1,477}='lux10_20151028T2057';
DataSets{1,478}='lux10_20151029T0456';
DataSets{1,479}='lux10_20151029T1250';
DataSets{1,480}='lux10_20151029T2049';
DataSets{1,481}='lux10_20151030T0024';
DataSets{1,482}='lux10_20151030T0646';
DataSets{1,483}='lux10_20151030T1437';
DataSets{1,484}='lux10_20151030T2229';
DataSets{1,485}='lux10_20151031T0623';
DataSets{1,486}='lux10_20151031T1421';
DataSets{1,487}='lux10_20151031T2220';
DataSets{1,488}='lux10_20151101T0151';
DataSets{1,489}='lux10_20151101T0843';
DataSets{1,490}='lux10_20151101T1718';
DataSets{1,491}='lux10_20151102T0122';
DataSets{1,492}='lux10_20151102T1041';
DataSets{1,493}='lux10_20151102T1356';
DataSets{1,494}='lux10_20151105T1115';
DataSets{1,495}='lux10_20151105T1924';
DataSets{1,496}='lux10_20151106T0323';
DataSets{1,497}='lux10_20151106T1128';
DataSets{1,498}='lux10_20151106T1936';
DataSets{1,499}='lux10_20151107T0339';
DataSets{1,500}='lux10_20151107T1141';
DataSets{1,501}='lux10_20151107T1953';
DataSets{1,502}='lux10_20151108T0051';
DataSets{1,503}='lux10_20151108T0901';
DataSets{1,504}='lux10_20151108T1702';
DataSets{1,505}='lux10_20151109T0110';
DataSets{1,506}='lux10_20151109T0914';
DataSets{1,507}='lux10_20151109T1712';
DataSets{1,508}='lux10_20151110T0117';
DataSets{1,509}='lux10_20151110T0935';
DataSets{1,510}='lux10_20151110T1742';
DataSets{1,511}='lux10_20151111T0149';
DataSets{1,512}='lux10_20151112T1205';
DataSets{1,513}='lux10_20151112T2010';
DataSets{1,514}='lux10_20151113T0414';
DataSets{1,515}='lux10_20151113T1222';
DataSets{1,516}='lux10_20151113T2027';
DataSets{1,517}='lux10_20151114T0438';
DataSets{1,518}='lux10_20151114T1241';
DataSets{1,519}='lux10_20151114T2045';
DataSets{1,520}='lux10_20151115T0051';
DataSets{1,521}='lux10_20151115T0856';
DataSets{1,522}='lux10_20151115T1658';
DataSets{1,523}='lux10_20151116T0101';
DataSets{1,524}='lux10_20151116T1010';
DataSets{1,525}='lux10_20151116T1350';
DataSets{1,526}='lux10_20151116T2156';
DataSets{1,527}='lux10_20151117T0603';
DataSets{1,528}='lux10_20151117T1402';
DataSets{1,529}='lux10_20151117T2206';
DataSets{1,530}='lux10_20151118T0610';
DataSets{1,531}='lux10_20151118T1229';
DataSets{1,532}='lux10_20151118T1822';
DataSets{1,533}='lux10_20151120T0900';
DataSets{1,534}='lux10_20151120T1655';
DataSets{1,535}='lux10_20151121T0052';
DataSets{1,536}='lux10_20151121T0852';
DataSets{1,537}='lux10_20151121T1653';
DataSets{1,538}='lux10_20151122T0052';
DataSets{1,539}='lux10_20151122T0855';
DataSets{1,540}='lux10_20151122T1654';
DataSets{1,541}='lux10_20151123T0050';
DataSets{1,542}='lux10_20151123T0855';
DataSets{1,543}='lux10_20151123T1649';
DataSets{1,544}='lux10_20151124T0045';
DataSets{1,545}='lux10_20151124T0918';
DataSets{1,546}='lux10_20151124T1332';
DataSets{1,547}='lux10_20151124T2132';
DataSets{1,548}='lux10_20151125T0537';
DataSets{1,549}='lux10_20151125T1333';
DataSets{1,550}='lux10_20151125T2134';
DataSets{1,551}='lux10_20151126T0530';
DataSets{1,552}='lux10_20151127T1122';
DataSets{1,553}='lux10_20151127T1917';
DataSets{1,554}='lux10_20151128T0314';
DataSets{1,555}='lux10_20151128T1107';
DataSets{1,556}='lux10_20151128T1911';
DataSets{1,557}='lux10_20151129T0051';
DataSets{1,558}='lux10_20151129T0848';
DataSets{1,559}='lux10_20151129T1644';
DataSets{1,560}='lux10_20151130T0042';
DataSets{1,561}='lux10_20151130T1117';
DataSets{1,562}='lux10_20151130T1918';
DataSets{1,563}='lux10_20151201T0321';
DataSets{1,564}='lux10_20151201T1119';
DataSets{1,565}='lux10_20151201T1921';
DataSets{1,566}='lux10_20151202T0316';
DataSets{1,567}='lux10_20151203T1553';
DataSets{1,568}='lux10_20151203T2350';
DataSets{1,569}='lux10_20151204T0744';
DataSets{1,570}='lux10_20151204T1540';
DataSets{1,571}='lux10_20151204T2338';
DataSets{1,572}='lux10_20151205T0735';
DataSets{1,573}='lux10_20151205T1527';
DataSets{1,574}='lux10_20151206T0051';
DataSets{1,575}='lux10_20151206T0849';
DataSets{1,576}='lux10_20151206T1645';
DataSets{1,577}='lux10_20151208T0928';
DataSets{1,578}='lux10_20151208T1734';
DataSets{1,579}='lux10_20151208T2336';
DataSets{1,580}='lux10_20151209T0744';
DataSets{1,581}='lux10_20151209T1534';
DataSets{1,582}='lux10_20151209T2334';
DataSets{1,583}='lux10_20151210T0736';
DataSets{1,584}='lux10_20151210T1553';
DataSets{1,585}='lux10_20151210T2353';
DataSets{1,586}='lux10_20151211T0833';
DataSets{1,587}='lux10_20151211T1136';
DataSets{1,588}='lux10_20151211T1933';
DataSets{1,589}='lux10_20151212T0331';
DataSets{1,590}='lux10_20151212T1133';
DataSets{1,591}='lux10_20151212T1937';
DataSets{1,592}='lux10_20151213T0051';
DataSets{1,593}='lux10_20151213T0852';
DataSets{1,594}='lux10_20151213T1657';
DataSets{1,595}='lux10_20151214T0101';
DataSets{1,596}='lux10_20151214T1100';
DataSets{1,597}='lux10_20151214T1857';
DataSets{1,598}='lux10_20151215T0256';
DataSets{1,599}='lux10_20151215T1105';
DataSets{1,600}='lux10_20151215T1907';
DataSets{1,601}='lux10_20151216T1110';
DataSets{1,602}='lux10_20151217T1016';
DataSets{1,603}='lux10_20151217T1330';
DataSets{1,604}='lux10_20151217T2125';
DataSets{1,605}='lux10_20151218T0516';
set(gcf,'Visible','off')
addpath('/scratch/dkhaitan/IsolatedS1S2/r1');
RunSetting='/scratch/dkhaitan/IsolatedS1S2/r1/Settings_SR21_BH.xml';


cd '/scratch/dkhaitan/IsolatedS1S2/r1/';
DataOutPath = ['/scratch/dkhaitan/IsolatedS1S2/salt_output/'];
MaxDriftLength = 35000;

	DataSet=DataSets{1,iij};
	disp([DataSet])
	DataPath = ['/scratch/dkhaitan/LUXData/IsolatedS1S2/' DataSet '/'];
	FileList = dir([DataPath '*.dat']);
	FileListToRun = FileList;%datasample(FileList,NumberOfFiles,'Replace',false);

	Setting = XMLReader_framework(RunSetting);
	temp_isolated_s1_rate = 0;
	isolated_s2_rate = 0;
	s1_spect = zeros(1,1000);
	s2_spect = zeros(1,1000);
	livetime=0;
	counter=0;


	parfor ii=1:length(FileListToRun)
		try
			disp([ii,FileListToRun(ii).name]);
			[FileOut,ee_merge] = Level2(FileListToRun(ii).name,DataPath,DataOutPath,DataSet,Setting);
			[temp_is1r,temp_is2r,temp_is1s,temp_is2s,temp_s1r,temp_s2r,temp_s1s,temp_s2s,temp_lt,temp_ilt,temp_aqlt] = IsolateS1S2s_IncludeNew(ee_merge,MaxDriftLength);

			fid_s1_spect=fopen([DataOutPath DataSet 'iso_s1_spect.csv'],'at');
			fprintf(fid_s1_spect,'%s,',num2str(temp_is1r));
			fprintf(fid_s1_spect,'%s,',num2str(temp_ilt));
			fprintf(fid_s1_spect,'%s,',num2str(temp_aqlt));
			dlmwrite([DataOutPath DataSet 'iso_s1_spect.csv'],temp_is1s,'-append','delimiter',',');
			fclose(fid_s1_spect);

			fid_s1_spect=fopen([DataOutPath DataSet 's1_spect.csv'],'at');
			fprintf(fid_s1_spect,'%s,',num2str(temp_s1r));
			fprintf(fid_s1_spect,'%s,',num2str(temp_lt));
			dlmwrite([DataOutPath DataSet 's1_spect.csv'],temp_s1s,'-append','delimiter',',');
			fclose(fid_s1_spect);

			fid_s2_spect=fopen([DataOutPath DataSet 'iso_s2_spect.csv'],'at');
			fprintf(fid_s2_spect,'%s,',num2str(temp_is2r));
			fprintf(fid_s2_spect,'%s,',num2str(temp_ilt));
			fprintf(fid_s2_spect,'%s,',num2str(temp_aqlt));
			dlmwrite([DataOutPath DataSet 'iso_s2_spect.csv'],temp_is2s,'-append','delimiter',',');
			fclose(fid_s2_spect);

			fid_s1_spect=fopen([DataOutPath DataSet 's2_spect.csv'],'at');
			fprintf(fid_s2_spect,'%s,',num2str(temp_s2r));
			fprintf(fid_s2_spect,'%s,',num2str(temp_lt));
			dlmwrite([DataOutPath DataSet 's2_spect.csv'],temp_s1s,'-append','delimiter',',');
			fclose(fid_s1_spect);


		catch exception
			disp(['Fail ' FileList(ii).name])
		end
		%clearvars -global -except DataSets DataSet DataPath DataOutPath MaxDriftLength FileList FileListToRun NumberOfFiles Setting isolated_s1_rate isolated_s2_rate s1_spect s2_spect livetime counter
	end
	iso_s1_rate = 0;
	iso_s2_rate = 0;
	iso_s1_spect = zeros(1,1000);
	iso_s2_spect = zeros(1,1000);
	s1_rate = 0;
	s2_rate = 0;
	s1_spect = zeros(1,1000);
	s2_spect = zeros(1,1000);
	livetime=0;
	ilt = 0;
	aqlt = 0;

	dummy = csvread([DataOutPath DataSet 'iso_s1_spect.csv']);
	dummy = sum(dummy);
	iso_s1_rate = dummy(1);
	ilt = dummy(2);
	aqlt = dummy(3);
	iso_s1_spect = dummy(4:length(dummy));

	dummy = csvread([DataOutPath DataSet 's1_spect.csv']);
	dummy = sum(dummy);
	s1_rate = dummy(1);
	lt = dummy(2);
	s1_spect = dummy(3:length(dummy));

	dummy = csvread([DataOutPath DataSet 'iso_s2_spect.csv']);
	dummy = sum(dummy);
	iso_s2_rate = dummy(1);
	ilt = dummy(2);
	aqlt = dummy(3);
	iso_s2_spect = dummy(4:length(dummy));

	dummy = csvread([DataOutPath DataSet 's2_spect.csv']);
	dummy = sum(dummy);
	s2_rate = dummy(1);
	lt = dummy(2);
	s2_spect = dummy(3:length(dummy));

	fid_s1_spect=fopen([DataOutPath 'total_iso_s1_spect_real1.csv'],'at');
	fprintf(fid_s1_spect,'%s,',DataSet);
	fprintf(fid_s1_spect,'%s,',num2str(iso_s1_rate));
	fprintf(fid_s1_spect,'%s,',num2str(ilt));
	fprintf(fid_s1_spect,'%s,',num2str(aqlt));
	dlmwrite([DataOutPath 'total_iso_s1_spect_real1.csv'],iso_s1_spect,'-append','delimiter',',');
	fclose(fid_s1_spect);

	fid_s1_spect=fopen([DataOutPath 'total_s1_spect_real1.csv'],'at');
	fprintf(fid_s1_spect,'%s,',DataSet);
	fprintf(fid_s1_spect,'%s,',num2str(s1_rate));
	fprintf(fid_s1_spect,'%s,',num2str(lt));
	dlmwrite([DataOutPath 'total_s1_spect_real1.csv'],s1_spect,'-append','delimiter',',');
	fclose(fid_s1_spect);


	fid_s2_spect=fopen([DataOutPath 'total_iso_s2_spect_real1.csv'],'at');
	fprintf(fid_s2_spect,'%s,',DataSet);
	fprintf(fid_s2_spect,'%s,',num2str(iso_s2_rate));
	fprintf(fid_s2_spect,'%s,',num2str(ilt));
	fprintf(fid_s2_spect,'%s,',num2str(aqlt));
	dlmwrite([DataOutPath 'total_s2_spect_real1.csv'],iso_s2_spect,'-append','delimiter',',');
	fclose(fid_s2_spect);

	fid_s2_spect=fopen([DataOutPath 'total_s2_spect_real1.csv'],'at');
	fprintf(fid_s2_spect,'%s,',DataSet);
	fprintf(fid_s2_spect,'%s,',num2str(s2_rate));
	fprintf(fid_s2_spect,'%s,',num2str(lt));
	dlmwrite([DataOutPath 'total_iso_s2_spect_real1.csv'],s2_spect,'-append','delimiter',',');
	fclose(fid_s2_spect);

	delete([DataOutPath DataSet 's2_spect.csv'])
	delete([DataOutPath DataSet 's1_spect.csv'])
	delete([DataOutPath DataSet 'iso_s2_spect.csv'])
	delete([DataOutPath DataSet 'iso_s1_spect.csv'])

	
end
